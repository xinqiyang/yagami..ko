#!/bin/sh
##############################################################################
# DDoS-Defender version 2.1.0 Author: Sunshine Koo <350311204@qq.com>        #
##############################################################################
#                                                                            #
# Example: ./sendmail "emailtest"                                            #
##############################################################################

CONF_FILE="/usr/local/DDos/conf/ddos.conf"

load_conf()
{
	if [ -f "$CONF_FILE" ] && [ ! "$CONF_FILE" == "" ]; then
		source $CONF_FILE
	else
		echo "\$CONF_FILE not found,Sendmail error..." |tee -a $LOGS_FILE
		exit 1
	fi
}
load_conf
#from='root@local.com'
#to='lanxera@yeah.net'
email_subject=$1
email_content=$2
email_date=$(date "+%Y-%m-%d_%H:%M:%S")
email_subject=$email_subject"__"$email_date

if [ `expr length "$EMAIL_TO"` -ne 0 ]; then
	for Addrs in $EMAIL_TO
	do
	  if [ $EMAIL_ATTACH -eq 0 ];then
         echo $EMAIL_SIGE | mutt $Addrs -s $email_subject -i $email_content
		 echo "$email_subject,MailTo $Addrs Success."
      else
	     email_attach=$3
		 if [ -f "$email_attach" ] && [ ! "$email_attach" == "" ];then
           echo $EMAIL_SIGE | mutt $Addrs -s $email_subject -i $email_content -a $email_attach
		   echo "$email_subject,MailTo $Addrs Success." 
		 else
           echo "Attach Not a file or Empty file."		 
		 fi
      fi
	done
fi


